<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using viz • exploreRGEE</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using viz">
<meta property="og:description" content="exploreRGEE">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">exploreRGEE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-book"></span>
     
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/get_functions.html">Get functions</a>
    </li>
    <li>
      <a href="../articles/vizualizing.html">Vizualizing</a>
    </li>
    <li>
      <a href="../articles/reduceRegions.html">Reduce Regions</a>
    </li>
    <li>
      <a href="../articles/band.html">Time Series (band)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">reference</a>
</li>
<li>
  <a href="https://github.com/joshualerickson/exploreRGEE/" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using viz</h1>
                        <h4 data-toc-skip class="author">Josh Erickson</h4>
            
            <h4 data-toc-skip class="date">3/6/2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/joshualerickson/exploreRGEE/blob/HEAD/vignettes/vizualizing.Rmd" class="external-link"><code>vignettes/vizualizing.Rmd</code></a></small>
      <div class="hidden name"><code>vizualizing.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="intro">Intro<a class="anchor" aria-label="anchor" href="#intro"></a>
</h2>
<p>This vignette will go over the different capabilities of the <code><a href="../reference/viz.html">viz()</a></code> function. The main purpose of <code><a href="../reference/viz.html">viz()</a></code> is to vizualize earth engine Images quickly. To do that, we need to either know the Image range prior (-1 to 1) or we need to calculate some quick stats (min and max) or my favorite, guess. The former is the fastest and works well for normalized indices (NDVI, NDWI) but when dealing with other Images it’s not as clear cut. This leads to continuously using infamous getInfo() function from GEE on the side to find these parameters when exploring. However, the <code><a href="../reference/viz.html">viz()</a></code> function will run getInfo() in the background for you if <code>min</code> and <code>max</code> are not provided. In addition, the process to get the info can take a long time depending on the scale; thus, the scale is set high (250 meters) but it may make sense to make it even larger for faster processing or when dealing with coarser pixels, e.g. PRISM is 800m. The reason for this is that earth engine defaults to a 0 to 255 scale when no min or max value is given. Thus, <code><a href="../reference/viz.html">viz()</a></code> will help us do that quickly as shown in the examples below.</p>
</div>
<div class="section level2">
<h2 id="vizualizing">Vizualizing<a class="anchor" aria-label="anchor" href="#vizualizing"></a>
</h2>
<p>Let’s say we wanted to vizualize some remote sensing bands so that we can possibly extract some more meaningful variables in a ML model, i.e. say predicting stream occurrence. To do that, earth engine does the heavy lifting by providing remote sensing images (and <a href="https://github.com/r-spatial/rgee" class="external-link">rgee</a>) but we still need to be able to explore in a relatively quick manner. That’s where the <code>get_*()</code> along with <code><a href="../reference/viz.html">viz()</a></code> come into play.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joshualerickson/exploreRGEE" class="external-link">exploreRGEE</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mikejohnson51/AOI/" class="external-link">AOI</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/rgee/" class="external-link">rgee</a></span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/rgee/reference/ee_Initialize.html" class="external-link">ee_Initialize</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## --  [1mrgee 1.1.2.9000 [22m ---------------------------------- earthengine-api 0.1.264 -- 
##   [32mv [39m  [34muser: [39m  [32mnot_defined
##  [39m  [32mv [39m  [34mInitializing Google Earth Engine: [39m
  [32mv [39m  [34mInitializing Google Earth Engine: [39m  [32m DONE!
##  [39m
  [32mv [39m  [34mEarth Engine account: [39m  [32m [1musers/joshualerickson [22m [39m 
## --------------------------------------------------------------------------------</code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">huc</span> <span class="op">&lt;-</span> <span class="fu">exploreRGEE</span><span class="fu">::</span><span class="va"><a href="../reference/huc.html">huc</a></span>
<span class="va">ld8</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_landsat.html">get_landsat</a></span><span class="op">(</span><span class="va">huc</span>, method <span class="op">=</span> <span class="st">'ld8'</span>, stat <span class="op">=</span> <span class="st">'mean'</span>,
                   startDate <span class="op">=</span> <span class="st">'2014-01-01'</span>, endDate <span class="op">=</span> <span class="st">'2019-12-31'</span>,
                   c.low <span class="op">=</span> <span class="fl">7</span>, c.high <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<p>After processing the data we can now vizualize in a leaflet map.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ld8</span> <span class="op"><a href="https://rdrr.io/pkg/AOI/man/grapes-greater-than-grapes.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Error in viz(.): Need to choose a band name.</span></code></pre>
<p>If you get this error it’s because you didn’t specify the band you want to use for vizualizing. You can either put a character (see below), numeric (band = 1) or c(‘NIR’, ‘Green’, ‘Blue’). In addition, you can also call it in the <code>param</code> argument when you start but I’d recommend keeping all the bands. One reason to keep all bands is if you want to look at RGB or false-color composite or switch between bands quickly in the <code><a href="../reference/rr.html">rr()</a></code> and <code><a href="../reference/band.html">band()</a></code> functions.</p>
<p><strong>False Color</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ld8</span> <span class="op"><a href="https://rdrr.io/pkg/AOI/man/grapes-greater-than-grapes.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">3000</span>, band <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'NIR'</span>, <span class="st">'Green'</span>, <span class="st">'Blue'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="false_color.png" width="50%" style="display: block; margin: auto;"><strong>True Color</strong> -play with gamma to lighten up image.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ld8</span> <span class="op"><a href="https://rdrr.io/pkg/AOI/man/grapes-greater-than-grapes.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">3000</span>, band <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Red'</span>, <span class="st">'Green'</span>, <span class="st">'Blue'</span><span class="op">)</span>, gamma <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="natural_color.png" width="50%" style="display: block; margin: auto;"><strong>NDVI</strong></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ld8</span> <span class="op"><a href="https://rdrr.io/pkg/AOI/man/grapes-greater-than-grapes.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span>band <span class="op">=</span> <span class="st">'NDVI'</span><span class="op">)</span></code></pre></div>
<p><img src="viz_fig1.png" width="50%" style="display: block; margin: auto;"></p>
<p><strong>Change Palette</strong></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># palettes use hcl.pals()</span>

<span class="va">ld8</span> <span class="op"><a href="https://rdrr.io/pkg/AOI/man/grapes-greater-than-grapes.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span>band <span class="op">=</span> <span class="st">"NDVI"</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">1</span>, 
            palette <span class="op">=</span> <span class="st">'RdYlGn'</span><span class="op">)</span></code></pre></div>
<p><img src="viz_fig2.png" width="50%" style="display: block; margin: auto;"></p>
<p>Now let’s say we want to look at the standard deviation. We’ll just grab the landsat image from above and change the <code>stat</code> argument. An important note is that if you use <code>stdDev</code> you have to explicitly call the <code>param</code> argument in the <code>get_*()</code>. Here, we changed the palette and reversed the order of that palette.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ld8</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_landsat.html">get_landsat</a></span><span class="op">(</span><span class="va">huc</span>, method <span class="op">=</span> <span class="st">'ld8'</span>, stat <span class="op">=</span> <span class="st">'stdDev'</span>,
                   param <span class="op">=</span> <span class="st">'NDVI'</span>,
                   startDate <span class="op">=</span> <span class="st">'2014-01-01'</span>, endDate <span class="op">=</span> <span class="st">'2019-12-31'</span>,
                   c.low <span class="op">=</span> <span class="fl">7</span>, c.high <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ld8</span> <span class="op"><a href="https://rdrr.io/pkg/AOI/man/grapes-greater-than-grapes.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">30</span>, palette <span class="op">=</span> <span class="st">'Spectral'</span>, reverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </code></pre></div>
<p><img src="viz_fig3.png" width="50%" style="display: block; margin: auto;"></p>
<p>We can also use <code><a href="../reference/viz.html">viz()</a></code> to help us vizualize differences in images. Let’s look at the states Montana and Idaho and see what the difference from 2000-2009 to 2010-2019 would be for precipitation using GRIDMET. When using the <code><a href="../reference/get_diff.html">get_diff()</a></code> with <code><a href="../reference/viz.html">viz()</a></code> we will get some color intervals for the difference calculations. Black meaning near zero, red (negative), green/blue (positive).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aoi</span> <span class="op">&lt;-</span> <span class="fu">AOI</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AOI/man/aoi_get.html" class="external-link">aoi_get</a></span><span class="op">(</span>state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Montana'</span>, <span class="st">'Idaho'</span><span class="op">)</span><span class="op">)</span>
<span class="va">prism</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_met.html">get_met</a></span><span class="op">(</span><span class="va">aoi</span>, method <span class="op">=</span> <span class="st">'GRIDMET'</span>, startDate <span class="op">=</span> <span class="st">'2000-01-01'</span>, endDate <span class="op">=</span> <span class="st">'2009-12-31'</span>, param <span class="op">=</span> <span class="st">'pr'</span><span class="op">)</span>

<span class="fu"><a href="../reference/get_diff.html">get_diff</a></span><span class="op">(</span><span class="va">prism</span>, startDate2 <span class="op">=</span> <span class="st">'2010-01-01'</span>, endDate2 <span class="op">=</span> <span class="st">'2019-12-31'</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/AOI/man/grapes-greater-than-grapes.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="viz_fig4.png" width="50%" style="display: block; margin: auto;"></p>
<p>Or if we want to look at the difference of landsat <strong>NDVI</strong> for the same time period you can do that as well.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ld_ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_landsat.html">get_landsat</a></span><span class="op">(</span><span class="va">huc</span>, method <span class="op">=</span> <span class="st">'ts'</span>, stat <span class="op">=</span> <span class="st">'mean'</span>,
                    startDate <span class="op">=</span> <span class="st">'2000-01-01'</span>, endDate <span class="op">=</span> <span class="st">'2009-12-31'</span>,
                   c.low <span class="op">=</span> <span class="fl">7</span>, c.high <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>

<span class="fu"><a href="../reference/get_diff.html">get_diff</a></span><span class="op">(</span><span class="va">ld_ts</span>, startDate2 <span class="op">=</span> <span class="st">'2010-01-01'</span>, endDate2 <span class="op">=</span> <span class="st">'2019-12-31'</span>,band <span class="op">=</span> <span class="st">"NDVI"</span> <span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/AOI/man/grapes-greater-than-grapes.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="viz_fig5.png" width="50%" style="display: block; margin: auto;"></p>
<p>Finally, you can always use a class ‘ee.image.Image’ with <code><a href="../reference/viz.html">viz()</a></code>. For example, let’s use the <a href="https://github.com/davemlz/eemont" class="external-link">eemont</a> processing steps and then vizualize.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/reticulate" class="external-link">reticulate</a></span><span class="op">)</span>
<span class="va">eemont</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reticulate/man/import.html" class="external-link">import</a></span><span class="op">(</span><span class="st">'eemont'</span><span class="op">)</span>

<span class="va">aoi</span> <span class="op">&lt;-</span> <span class="fu">exploreRGEE</span><span class="fu">:::</span><span class="fu">setup</span><span class="op">(</span><span class="va">huc</span><span class="op">)</span>

<span class="va">ld8</span> <span class="op">&lt;-</span> <span class="va">ee</span><span class="op">$</span><span class="fu">ImageCollection</span><span class="op">(</span><span class="st">"LANDSAT/LC08/C01/T1_SR"</span><span class="op">)</span><span class="op">$</span><span class="fu">filterBounds</span><span class="op">(</span><span class="va">aoi</span><span class="op">)</span>
<span class="va">ld8</span> <span class="op">&lt;-</span> <span class="va">ld8</span><span class="op">$</span><span class="fu">maskClouds</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">scale</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">index</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'GNDVI'</span>,<span class="st">'NDWI'</span>,<span class="st">'BAI'</span>,<span class="st">'NDSI'</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="fu">median</span><span class="op">(</span><span class="op">)</span>

<span class="va">ld8</span> <span class="op"><a href="https://rdrr.io/pkg/AOI/man/grapes-greater-than-grapes.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span>user_shape <span class="op">=</span> <span class="va">huc</span>, band <span class="op">=</span> <span class="st">'NDWI'</span><span class="op">)</span></code></pre></div>
<p><strong>NDWI</strong> <img src="viz_fig6.png" width="50%" style="display: block; margin: auto;"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Josh Erickson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.9000.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
